<!DOCTYPE html>
<html>
<head>
  <title>Chat Application</title>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const socket = io();

      socket.on('message', (data) => {
        const messages = document.getElementById('messages');
        const messageItem = document.createElement('li');
        messageItem.textContent = `${data.sender}: ${data.message}`;
        messages.appendChild(messageItem);
      });

      socket.on('chatHistory', (messages) => {
        const messageList = document.getElementById('messages');
        messageList.innerHTML = '';
        messages.forEach((msg) => {
          const messageItem = document.createElement('li');
          messageItem.textContent = `${msg.sender}: ${msg.message}`;
          messageList.appendChild(messageItem);
        });
      });

      document.getElementById('send').addEventListener('click', () => {
        const sender = document.getElementById('sender').value;
        const message = document.getElementById('message').value;
        const group = document.getElementById('group').value;
        socket.emit('message', { sender, message, group });
        document.getElementById('message').value = '';
      });

      document.getElementById('group').addEventListener('change', () => {
        const group = document.getElementById('group').value;
        socket.emit('joinGroup', { group });
        document.getElementById('messages').innerHTML = ''; // Clear messages on group change
      });

      // Emit joinGroup event for the default group
      socket.emit('joinGroup', { group: document.getElementById('group').value });
    });
  </script>
</head>
<body>
<h1>Chat Application</h1>
<input id="sender" placeholder="Your name">
<select id="group">
  <option value="group1">Group 1</option>
  <option value="group2">Group 2</option>
  <option value="group3">Group 3</option>
  <!-- Add more groups as needed -->
</select>
<input id="message" placeholder="Your message">
<button id="send">Send</button>
<ul id="messages"></ul>
</body>
</html>
